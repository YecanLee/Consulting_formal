2025-05-27 14:43:24,087 INFO    MainThread:1304093 [wandb_setup.py:_flush():70] Current SDK version is 0.19.11
2025-05-27 14:43:24,088 INFO    MainThread:1304093 [wandb_setup.py:_flush():70] Configure stats pid to 1304093
2025-05-27 14:43:24,088 INFO    MainThread:1304093 [wandb_setup.py:_flush():70] Loading settings from /home/ra78lof/.config/wandb/settings
2025-05-27 14:43:24,088 INFO    MainThread:1304093 [wandb_setup.py:_flush():70] Loading settings from /home/ra78lof/consulting_pro/ebseg/wandb/settings
2025-05-27 14:43:24,088 INFO    MainThread:1304093 [wandb_setup.py:_flush():70] Loading settings from environment variables
2025-05-27 14:43:24,088 INFO    MainThread:1304093 [wandb_init.py:setup_run_log_directory():724] Logging user logs to /home/ra78lof/consulting_pro/ebseg/wandb/run-20250527_144324-s9utbgi1/logs/debug.log
2025-05-27 14:43:24,088 INFO    MainThread:1304093 [wandb_init.py:setup_run_log_directory():725] Logging internal logs to /home/ra78lof/consulting_pro/ebseg/wandb/run-20250527_144324-s9utbgi1/logs/debug-internal.log
2025-05-27 14:43:24,088 INFO    MainThread:1304093 [wandb_init.py:init():852] calling init triggers
2025-05-27 14:43:24,088 INFO    MainThread:1304093 [wandb_init.py:init():857] wandb.init called with sweep_config: {}
config: {'model': CfgNode({'LOAD_PROPOSALS': False, 'MASK_ON': True, 'KEYPOINT_ON': False, 'DEVICE': 'cuda', 'META_ARCHITECTURE': 'EBSeg', 'WEIGHTS': '', 'PIXEL_MEAN': [103.53, 116.28, 123.675], 'PIXEL_STD': [1.0, 1.0, 1.0], 'BACKBONE': CfgNode({'NAME': 'build_resnet_backbone', 'FREEZE_AT': 2}), 'FPN': CfgNode({'IN_FEATURES': [], 'OUT_CHANNELS': 256, 'NORM': '', 'FUSE_TYPE': 'sum'}), 'PROPOSAL_GENERATOR': CfgNode({'NAME': 'RPN', 'MIN_SIZE': 0}), 'ANCHOR_GENERATOR': CfgNode({'NAME': 'DefaultAnchorGenerator', 'SIZES': [[32, 64, 128, 256, 512]], 'ASPECT_RATIOS': [[0.5, 1.0, 2.0]], 'ANGLES': [[-90, 0, 90]], 'OFFSET': 0.0}), 'RPN': CfgNode({'HEAD_NAME': 'StandardRPNHead', 'IN_FEATURES': ['res4'], 'BOUNDARY_THRESH': -1, 'IOU_THRESHOLDS': [0.3, 0.7], 'IOU_LABELS': [0, -1, 1], 'BATCH_SIZE_PER_IMAGE': 256, 'POSITIVE_FRACTION': 0.5, 'BBOX_REG_LOSS_TYPE': 'smooth_l1', 'BBOX_REG_LOSS_WEIGHT': 1.0, 'BBOX_REG_WEIGHTS': (1.0, 1.0, 1.0, 1.0), 'SMOOTH_L1_BETA': 0.0, 'LOSS_WEIGHT': 1.0, 'PRE_NMS_TOPK_TRAIN': 12000, 'PRE_NMS_TOPK_TEST': 6000, 'POST_NMS_TOPK_TRAIN': 2000, 'POST_NMS_TOPK_TEST': 1000, 'NMS_THRESH': 0.7, 'CONV_DIMS': [-1]}), 'ROI_HEADS': CfgNode({'NAME': 'Res5ROIHeads', 'NUM_CLASSES': 80, 'IN_FEATURES': ['res4'], 'IOU_THRESHOLDS': [0.5], 'IOU_LABELS': [0, 1], 'BATCH_SIZE_PER_IMAGE': 512, 'POSITIVE_FRACTION': 0.25, 'SCORE_THRESH_TEST': 0.05, 'NMS_THRESH_TEST': 0.5, 'PROPOSAL_APPEND_GT': True}), 'ROI_BOX_HEAD': CfgNode({'NAME': '', 'BBOX_REG_LOSS_TYPE': 'smooth_l1', 'BBOX_REG_LOSS_WEIGHT': 1.0, 'BBOX_REG_WEIGHTS': (10.0, 10.0, 5.0, 5.0), 'SMOOTH_L1_BETA': 0.0, 'POOLER_RESOLUTION': 14, 'POOLER_SAMPLING_RATIO': 0, 'POOLER_TYPE': 'ROIAlignV2', 'NUM_FC': 0, 'FC_DIM': 1024, 'NUM_CONV': 0, 'CONV_DIM': 256, 'NORM': '', 'CLS_AGNOSTIC_BBOX_REG': False, 'TRAIN_ON_PRED_BOXES': False, 'USE_FED_LOSS': False, 'USE_SIGMOID_CE': False, 'FED_LOSS_FREQ_WEIGHT_POWER': 0.5, 'FED_LOSS_NUM_CLASSES': 50}), 'ROI_BOX_CASCADE_HEAD': CfgNode({'BBOX_REG_WEIGHTS': ((10.0, 10.0, 5.0, 5.0), (20.0, 20.0, 10.0, 10.0), (30.0, 30.0, 15.0, 15.0)), 'IOUS': (0.5, 0.6, 0.7)}), 'ROI_MASK_HEAD': CfgNode({'NAME': 'MaskRCNNConvUpsampleHead', 'POOLER_RESOLUTION': 14, 'POOLER_SAMPLING_RATIO': 0, 'NUM_CONV': 0, 'CONV_DIM': 256, 'NORM': '', 'CLS_AGNOSTIC_MASK': False, 'POOLER_TYPE': 'ROIAlignV2'}), 'ROI_KEYPOINT_HEAD': CfgNode({'NAME': 'KRCNNConvDeconvUpsampleHead', 'POOLER_RESOLUTION': 14, 'POOLER_SAMPLING_RATIO': 0, 'CONV_DIMS': (512, 512, 512, 512, 512, 512, 512, 512), 'NUM_KEYPOINTS': 17, 'MIN_KEYPOINTS_PER_IMAGE': 1, 'NORMALIZE_LOSS_BY_VISIBLE_KEYPOINTS': True, 'LOSS_WEIGHT': 1.0, 'POOLER_TYPE': 'ROIAlignV2'}), 'SEM_SEG_HEAD': CfgNode({'NAME': 'EBSeg_Mask2former_Head', 'IN_FEATURES': ['res2', 'res3', 'res4', 'res5'], 'IGNORE_VALUE': 255, 'NUM_CLASSES': 54, 'CONVS_DIM': 256, 'COMMON_STRIDE': 4, 'NORM': 'GN', 'LOSS_WEIGHT': 1.0, 'LOSS_TYPE': 'hard_pixel_mining', 'PROJECT_FEATURES': ['res2'], 'PROJECT_CHANNELS': [48], 'ASPP_CHANNELS': 256, 'ASPP_DILATIONS': [6, 12, 18], 'ASPP_DROPOUT': 0.1, 'USE_DEPTHWISE_SEPARABLE_CONV': False, 'MASK_DIM': 256, 'TRANSFORMER_ENC_LAYERS': 6, 'PIXEL_DECODER_NAME': 'MSDeformAttnPixelDecoder', 'DEFORMABLE_TRANSFORMER_ENCODER_IN_FEATURES': ['res3', 'res4', 'res5'], 'DEFORMABLE_TRANSFORMER_ENCODER_N_POINTS': 4, 'DEFORMABLE_TRANSFORMER_ENCODER_N_HEADS': 8}), 'PANOPTIC_FPN': CfgNode({'INSTANCE_LOSS_WEIGHT': 1.0, 'COMBINE': CfgNode({'ENABLED': True, 'OVERLAP_THRESH': 0.5, 'STUFF_AREA_LIMIT': 4096, 'INSTANCES_CONFIDENCE_THRESH': 0.5})}), 'RETINANET': CfgNode({'NUM_CLASSES': 80, 'IN_FEATURES': ['p3', 'p4', 'p5', 'p6', 'p7'], 'NUM_CONVS': 4, 'IOU_THRESHOLDS': [0.4, 0.5], 'IOU_LABELS': [0, -1, 1], 'PRIOR_PROB': 0.01, 'SCORE_THRESH_TEST': 0.05, 'TOPK_CANDIDATES_TEST': 1000, 'NMS_THRESH_TEST': 0.5, 'BBOX_REG_WEIGHTS': (1.0, 1.0, 1.0, 1.0), 'FOCAL_LOSS_GAMMA': 2.0, 'FOCAL_LOSS_ALPHA': 0.25, 'SMOOTH_L1_LOSS_BETA': 0.1, 'BBOX_REG_LOSS_TYPE': 'smooth_l1', 'NORM': ''}), 'RESNETS': CfgNode({'DEPTH': 50, 'OUT_FEATURES': ['res4'], 'NUM_GROUPS': 1, 'NORM': 'FrozenBN', 'WIDTH_PER_GROUP': 64, 'STRIDE_IN_1X1': True, 'RES5_DILATION': 1, 'RES2_OUT_CHANNELS': 256, 'STEM_OUT_CHANNELS': 64, 'DEFORM_ON_PER_STAGE': [False, False, False, False], 'DEFORM_MODULATED': False, 'DEFORM_NUM_GROUPS': 1, 'RES4_DILATION': 1, 'RES5_MULTI_GRID': [1, 2, 4], 'STEM_TYPE': 'deeplab'}), 'EBSEG': CfgNode({'NO_OBJECT_WEIGHT': 0.1, 'CLASS_WEIGHT': 2.0, 'DICE_WEIGHT': 5.0, 'MASK_WEIGHT': 5.0, 'TRAIN_NUM_POINTS': 12544, 'NUM_CLASSES': 4, 'OVERSAMPLE_RATIO': 3.0, 'IMPORTANCE_SAMPLE_RATIO': 0.75, 'CLIP_MODEL_NAME': 'ViT-L-14-336', 'CLIP_PRETRAINED_NAME': 'openai', 'CLIP_TEMPLATE_SET': 'vild', 'FEATURE_LAST_LAYER_IDX': 18, 'HEAD_FIRST_LAYER_IDX': 9, 'CLIP_FROZEN_EXCLUDE': ['positional_embedding'], 'SIZE_DIVISIBILITY': 32, 'ASYMETRIC_INPUT': True, 'CLIP_RESOLUTION': 0.7, 'SEM_SEG_POSTPROCESS_BEFORE_INFERENCE': True}), 'SAM': CfgNode({'MODEL_NAME': 'vit_b'}), 'SAN_HEAD': CfgNode({'NUM_QUERIES': 100, 'CLIP_DEEPER_FROZEN_EXCLUDE': [], 'SOS_TOKEN_FORMAT': 'cls_token', 'REC_DOWNSAMPLE_METHOD': 'max'}), 'FLASH': False, 'MODIFIED': CfgNode({'SCOREMAP_LOSS_WEIGHT': 1.0, 'FUSION_ENCODER_LAYERS': 1, 'OVCLASSFIER_TYPE': 0, 'PROMPT_TRAINING': False, 'LOAD_PROMPT_PATH': '', 'WITH_SCOREMAP_BRANCH': True, 'WITH_AGG_LAYER': False, 'WITH_TEXT_FUSION': False, 'ONLY_SCOREMAP_BRANCH_TRAINING': True, 'TEXT_DIVERSIFICATION': False, 'SSC_LOSS': 'mse_loss'}), 'MASK_FORMER': CfgNode({'DEEP_SUPERVISION': True, 'NO_OBJECT_WEIGHT': 0.1, 'CLASS_WEIGHT': 2.0, 'DICE_WEIGHT': 5.0, 'MASK_WEIGHT': 5.0, 'NHEADS': 8, 'DROPOUT': 0.0, 'DIM_FEEDFORWARD': 2048, 'ENC_LAYERS': 0, 'DEC_LAYERS': 10, 'PRE_NORM': False, 'HIDDEN_DIM': 256, 'NUM_OBJECT_QUERIES': 100, 'TRANSFORMER_IN_FEATURE': 'multi_scale_pixel_decoder', 'ENFORCE_INPUT_PROJ': False, 'TEST': CfgNode({'SEMANTIC_ON': True, 'INSTANCE_ON': False, 'PANOPTIC_ON': False, 'OBJECT_MASK_THRESHOLD': 0.8, 'OVERLAP_THRESHOLD': 0.8, 'SEM_SEG_POSTPROCESSING_BEFORE_INFERENCE': False}), 'SIZE_DIVISIBILITY': 32, 'TRANSFORMER_DECODER_NAME': 'MultiScaleMaskedTransformerDecoder', 'TRAIN_NUM_POINTS': 12544, 'OVERSAMPLE_RATIO': 3.0, 'IMPORTANCE_SAMPLE_RATIO': 0.75})}), 'solver': CfgNode({'LR_SCHEDULER_NAME': 'WarmupPolyLR', 'MAX_ITER': 1000, 'BASE_LR': 1e-05, 'BASE_LR_END': 0.0, 'MOMENTUM': 0.9, 'NESTEROV': False, 'WEIGHT_DECAY': 0.05, 'WEIGHT_DECAY_NORM': 0.0, 'GAMMA': 0.1, 'STEPS': (30000,), 'NUM_DECAYS': 3, 'WARMUP_FACTOR': 1.0, 'WARMUP_ITERS': 0, 'WARMUP_METHOD': 'linear', 'RESCALE_INTERVAL': False, 'CHECKPOINT_PERIOD': 100, 'IMS_PER_BATCH': 1, 'REFERENCE_WORLD_SIZE': 0, 'BIAS_LR_FACTOR': 1.0, 'WEIGHT_DECAY_BIAS': None, 'CLIP_GRADIENTS': CfgNode({'ENABLED': True, 'CLIP_TYPE': 'full_model', 'CLIP_VALUE': 0.01, 'NORM_TYPE': 2.0}), 'AMP': CfgNode({'ENABLED': True}), 'POLY_LR_POWER': 0.9, 'POLY_LR_CONSTANT_ENDING': 0.0, 'WEIGHT_DECAY_EMBED': 0.0, 'WEIGHT_DECAY_EMBED_GROUP': ['absolute_pos_embed', 'positional_embedding', 'pos_embed', 'query_embed', 'relative_position_bias_table'], 'OPTIMIZER': 'ADAMW', 'BACKBONE_MULTIPLIER': 1.0, 'CLIP_MULTIPLIER': 1.0, 'TEST_IMS_PER_BATCH': 1, 'TEST_TIME_TRAINER': False}), 'cfg_file': 'configs/ebseg/ceiling_painting.yaml', '_wandb': {'code_path': 'code/ebseg/train_net.py'}}
2025-05-27 14:43:24,088 INFO    MainThread:1304093 [wandb_init.py:init():893] starting backend
2025-05-27 14:43:24,088 INFO    MainThread:1304093 [wandb_init.py:init():897] sending inform_init request
2025-05-27 14:43:24,093 INFO    MainThread:1304093 [backend.py:_multiprocessing_setup():101] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2025-05-27 14:43:24,093 INFO    MainThread:1304093 [wandb_init.py:init():907] backend started and connected
2025-05-27 14:43:24,095 INFO    MainThread:1304093 [wandb_init.py:init():1005] updated telemetry
2025-05-27 14:43:24,098 INFO    MainThread:1304093 [wandb_init.py:init():1029] communicating run to backend with 90.0 second timeout
2025-05-27 14:43:24,688 INFO    MainThread:1304093 [wandb_init.py:init():1104] starting run threads in backend
2025-05-27 14:43:24,751 INFO    MainThread:1304093 [wandb_run.py:_console_start():2573] atexit reg
2025-05-27 14:43:24,751 INFO    MainThread:1304093 [wandb_run.py:_redirect():2421] redirect: wrap_raw
2025-05-27 14:43:24,751 INFO    MainThread:1304093 [wandb_run.py:_redirect():2490] Wrapping output streams.
2025-05-27 14:43:24,751 INFO    MainThread:1304093 [wandb_run.py:_redirect():2513] Redirects installed.
2025-05-27 14:43:24,753 INFO    MainThread:1304093 [wandb_init.py:init():1150] run started, returning control to user process
2025-05-27 14:43:33,108 INFO    MainThread:1304093 [wandb_run.py:_finish():2321] finishing run scoutlee/EBSeg/s9utbgi1
2025-05-27 14:43:33,108 INFO    MainThread:1304093 [wandb_run.py:_atexit_cleanup():2538] got exitcode: 0
2025-05-27 14:43:33,108 INFO    MainThread:1304093 [wandb_run.py:_restore():2520] restore
2025-05-27 14:43:33,108 INFO    MainThread:1304093 [wandb_run.py:_restore():2526] restore done
2025-05-27 14:43:33,991 INFO    MainThread:1304093 [wandb_run.py:_footer_history_summary_info():4188] rendering history
2025-05-27 14:43:33,991 INFO    MainThread:1304093 [wandb_run.py:_footer_history_summary_info():4220] rendering summary
2025-05-27 14:43:33,992 INFO    MainThread:1304093 [wandb_run.py:_footer_sync_info():4149] logging synced files
